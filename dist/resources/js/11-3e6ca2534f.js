(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"18i6":function(e,t,o){},CN8t:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=c(o("Yz+Y")),n=c(o("iCc5")),i=c(o("V7oC")),r=c(o("FYw3")),s=c(o("mRg0")),l=c(o("q1tI"));c(o("17x9"));o("PrFZ");var u=o("i6OX"),d=c(u);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,n.default)(this,t);var o=(0,r.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));o.choose=function(e){o.setState({pathname:e},function(){o.props.history.push(e)})};var i=localStorage.getItem("shopInfo")?JSON.parse(localStorage.getItem("shopInfo")):{};return o.state={pathname:e.location.pathname,shopInfo:i},o}return(0,s.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){var e=this,t=this.state,o=t.pathname,a=t.shopInfo;return l.default.createElement("div",null,3!==a.merInfoTemplates.visitType?l.default.createElement("div",{className:"footer-bg clearfix"},l.default.createElement("div",{className:"/"===o?"item active":"item",onClick:function(){e.choose("/")}},l.default.createElement(d.default,{glyph:u.home}),"首页"),l.default.createElement("div",{className:"/my"===o?"item active":"item",onClick:function(){e.choose("/my")}},l.default.createElement(d.default,{glyph:u.user}),"我的")):"")}}]),t}(l.default.Component);t.default=f},Fzi1:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,n=o("CN8t"),i=(a=n)&&a.__esModule?a:{default:a};t.default=i.default},G2GN:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,n=o("b5pr"),i=(a=n)&&a.__esModule?a:{default:a};t.default=i.default},PrFZ:function(e,t,o){},Upkh:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=I(o("3UyF")),n=I(o("LajT")),i=I(o("NtIf")),r=I(o("QbLZ")),s=I(o("gDS+")),l=I(o("Kl5d")),u=I(o("YEIV")),d=I(o("Yz+Y")),c=I(o("iCc5")),f=I(o("V7oC")),p=I(o("FYw3")),h=I(o("mRg0"));o("RhWh"),o("BXRl"),o("9prx"),o("TttT");var m=I(o("q1tI")),g=o("MuoO"),v=(I(o("17x9")),o("sd4h"));I(o("i6OX"));o("dkPK");I(o("Rnav")),I(o("GBY4")),I(o("Fzi1"));function I(e){return e&&e.__esModule?e:{default:e}}var y=/^1(3|4|5|6|7|8|9)\d{9}$/,S=null,b=function(e){function t(e){(0,c.default)(this,t);var o=(0,p.default)(this,(t.__proto__||(0,d.default)(t)).call(this,e));return o.changeInput=function(e,t){o.setState((0,u.default)({},t,e))},o.onLogin=function(){var e=o.state,t=e.mobile,a=e.code;if(!y.test(t))return l.default.info("请输入正确的手机号码！");if(!a)return l.default.info("请输入验证码！");var n={mobile:t.replace(/\s/g,""),verCode:a};(0,o.props.dispatch)({type:"login/touristlogin",payload:n})},o.sendCode=function(){var e=o;o.setState({sendCodeTime:60}),S=setInterval(function(){var t=o.state.sendCodeTime;1===t&&clearInterval(S),t-=1,e.setState({sendCodeTime:t})},1e3)},o.sendSmsCode=function(){var e=o.state.mobile;if(!y.test(e))return l.default.info("请输入正确的手机号码！");(0,o.props.dispatch)({type:"login/getCode",payload:{mobile:e.replace(/\s/g,""),loginKey:"login"}})},o.onClose=function(){},o.state={mobile:"",code:"",sendCodeTime:0},o}return(0,h.default)(t,e),(0,f.default)(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,o=e.login,a=o.touristlogin,n=o.getCode;if(n!==t.login.getCode){var i=n.code,r=n.message;"1000"===i?(this.sendCode(),l.default.info("验证码已发送至"+this.state.mobile)):l.default.fail(r)}if(a!==this.props.login.touristlogin){var u=a.code,d=a.message,c=a.data;"1000"===u?(l.default.success("登录成功！"),localStorage.setItem("userInfo",(0,s.default)(c)),this.props.loginSuccess(c)):l.default.fail(d)}}},{key:"componentWillUnmount",value:function(){clearInterval(S)}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldProps,o=this.state,s=o.mobile,l=o.code,u=o.sendCodeTime;return m.default.createElement(a.default,{className:"mall-login-modal",visible:!0,transparent:!0,width:"6.16rem",maskClosable:!1,closable:!0,onClose:this.props.hideLoginModal,title:"短信验证码登录",footer:[],wrapProps:{onTouchStart:this.onWrapTouchStart},afterClose:function(){alert("afterClose")}},m.default.createElement("div",{className:"login-bg"},m.default.createElement(i.default,(0,r.default)({},t("mobile"),{placeholder:"请输入手机号",onChange:function(t){e.changeInput(t,"mobile")},value:s,onClick:function(e){e.currentTarget.focus()},maxLength:"11"})),m.default.createElement(i.default,(0,r.default)({},t("code"),{placeholder:"输入手机验证码",type:"number",maxLength:"4",onChange:function(t){e.changeInput(t,"code")},value:l,onClick:function(e){e.currentTarget.focus()},extra:m.default.createElement(n.default,{className:"link",onClick:this.sendSmsCode,disabled:!y.test(s)||y.test(s)&&u>1},u>1?m.default.createElement("span",null,"重新获取(",u,"s)"):m.default.createElement("span",null,"获取验证码"))})),m.default.createElement("div",{className:"btn-bg"},m.default.createElement("button",{className:"btn",onClick:this.onLogin},"登录"))))}}]),t}(m.default.Component);t.default=(0,g.connect)(function(e){return(0,r.default)({},e)})((0,v.createForm)()(b))},X4fA:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isLoginOrAuth=t.authorizationFailure=void 0;var a=i(o("gDS+")),n=i(o("1dND"));function i(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")):"",o=localStorage.getItem("shopInfo")?JSON.parse(localStorage.getItem("shopInfo")):"";if(t&&t.fuluToken||3==o.merInfoTemplates.visitType)return!0;var a=n.default.isAlipayOrWechat(),i=window.location.pathname+window.location.search;if(0===a||1===a)return window.location.href=configs.commonUrl+"?codeKey="+o.codeKey+"&backUrl="+encodeURIComponent(i),!1;if(2===o.merInfoTemplates.visitType)return t.fuluId&&!t.fuluToken?e.props.dispatch({type:"login/fuluusertoken",payload:{code:t.fuluId,env:3,type:!0}}):e.setState({showMallLoginModal:!0}),!1;var r=localStorage.getItem("userid"),s=localStorage.getItem("accesstoken"),l=configs.commonUrl+"?codeKey="+o.codeKey+"&backUrl="+encodeURIComponent(i);return r&&(l=l+"&userid="+r),s&&(l=l+"&accesstoken="+s),window.location.href=l,!1}t.authorizationFailure=function(e){var t=e.state.userInfo;t.fuluToken="",localStorage.setItem("userInfo",(0,a.default)(t)),e.setState({userInfo:t},function(){r(e)})},t.isLoginOrAuth=r},b5pr:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=g(o("QbLZ")),n=g(o("Kl5d")),i=g(o("gDS+")),r=g(o("Yz+Y")),s=g(o("iCc5")),l=g(o("V7oC")),u=g(o("FYw3")),d=g(o("mRg0"));o("TttT");var c=g(o("q1tI")),f=o("MuoO");g(o("17x9"));o("18i6");var p=g(o("Rnav")),h=o("X4fA"),m=g(o("Upkh"));function g(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,s.default)(this,t);var o=(0,u.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));o.getUserPriceNum=function(){o.props.dispatch({type:"prize/getPrizeNum",payload:{userId:o.state.userid}})},o.sendOrder=function(){var e=o.state,t=e.isprizeright;e.prizeNum;0===t?o.props.dispatch({type:"prize/prizeSendOrder"}):1===t&&o.props.history.push("./kaishichouj")},o.toUrl=function(e){o.props.history.push(e)},o.toLogin=function(){o.setState({isOrderList:!1},function(){(0,h.isLoginOrAuth)(o)})},o.loginSuccess=function(e){o.hideLoginModal(),o.setState({userInfo:e},function(){o.props.dispatch({type:"prize/activeOpen"})})},o.hideLoginModal=function(){o.setState({showMallLoginModal:!1})};var a=localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")):{},n=localStorage.getItem("shopInfo")?JSON.parse(localStorage.getItem("shopInfo")):{},i=localStorage.getItem("userid");return o.state={userInfo:a,shopInfo:n,userid:i,isprizeright:!1,showMallLoginModal:!1},o}return(0,d.default)(t,e),(0,l.default)(t,[{key:"componentDidMount",value:function(){(0,h.isLoginOrAuth)(this)&&this.props.dispatch({type:"prize/activeOpen"})}},{key:"chinapay",value:function(e){try{window.c_plugins.merchantBridge.callPaymentControl(function(e){"1"===e.isCancelPay||"1"===e.orderStatus&&this.props.history.push("./kaishichouj")},function(e){alert(e.message||e||"网络错误，请检查网络连接")},JSON.parse(e))}catch(e){alert(e)}}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,o=e.login.fuluusertoken,a=e.prize,r=a.getPrizeNumRes,s=(a.isPrizeRight,a.prizeSendOrderRes),l=a.saveUserDataRes,u=a.activeOpenRes,d=a.payInfoRes;if(o!==t.login.fuluusertoken){var c=o.code,f=o.data,p=o.message;"1000"===c?(localStorage.setItem("userInfo",(0,i.default)(f)),this.loginSuccess(f)):n.default.fail(p)}if(u!==t.prize.activeOpenRes&&"1000"===u.code&&(1===u.data.list[0].enable?(this.getUserPriceNum(),localStorage.setItem("activeId",u.data.list.length>0&&u.data.list[0].id)):2===u.data.list[0].enable&&this.setState({isprizeright:2})),l!==t.prize.saveUserDataRes&&l.code,s!==t.prize.prizeSendOrderRes&&"1000"===s.code&&(this.props.dispatch({type:"prize/saveUserData",payload:{orderNo:s.data.orderNo,productId:s.data.productId,userId:this.state.userid,mobile:this.state.mobile||"13036163226"}}),this.props.dispatch({type:"prize/payInfo",payload:{ProductName:"中国银行抽奖",OrderNo:s.data.orderNo,PayAmount:.01}})),d!==t.prize.payInfoRes&&"0"===d.code&&this.chinapay(d.data),r!==t.prize.getPrizeNumRes){var h=r.data,m=h.mobile,g=h.orderNo,v=h.prizeNum;"1000"===r.code?this.setState({isprizeright:1,prizeNum:v}):"1001"===r.code&&this.setState({isprizeright:0}),this.setState({mobile:m,orderNo:g,prizeNum:v}),localStorage.setItem("orderNo",g)}}},{key:"render",value:function(){var e=this,t=this.state,o=(t.userInfo,t.shopInfo,t.isprizeright),n=(t.btntxt,t.showMallLoginModal);return c.default.createElement("div",{className:"choujiang-bg"},c.default.createElement(p.default,(0,a.default)({},this.props,{jump:function(){e.props.history.goBack()}})),c.default.createElement("div",{className:"prizeList"}),o&&c.default.createElement("div",{onClick:this.sendOrder,className:"cj-btn"},0===o?"支付0.01参与抽奖":1===o?"立即抽奖":2===o?"活动已结束":""),n&&c.default.createElement(m.default,{loginSuccess:this.loginSuccess,hideLoginModal:this.hideLoginModal}))}}]),t}(c.default.Component);t.default=(0,f.connect)(function(e){return(0,a.default)({},e)})(v)},dkPK:function(e,t,o){}}]);