(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"5AJz":function(e,t,a){},"6/QC":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=S(a("QbLZ")),n=S(a("Kl5d")),s=S(a("m1cH")),l=S(a("BEI5")),c=S(a("LajT")),r=S(a("Yz+Y")),i=S(a("iCc5")),u=S(a("V7oC")),d=S(a("FYw3")),f=S(a("mRg0"));a("TttT"),a("EgL+"),a("BXRl");var p=S(a("q1tI")),m=a("MuoO"),h=S(a("Rnav")),g=S(a("GBY4"));function S(e){return e&&e.__esModule?e:{default:e}}a("5AJz");var v=function(e){function t(e){(0,i.default)(this,t);var a=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));a.getCouponsGoods=function(){var e=a.state.postData;a.props.dispatch({type:"coupons/GetCouponProductList",payload:e})},a.toDetail=function(e,t){a.props.history.push("/detail?gid="+e+(t?"&pid="+t:""))},a.renderRow=function(e,t,o){return p.default.createElement("li",{key:o,onClick:function(){a.toDetail(e.childCategoryId)}},p.default.createElement("div",{className:"left"},p.default.createElement("img",{src:e.iconPath}),e.cornerMark?p.default.createElement("div",{className:"sale-tips"},e.cornerMark):""),p.default.createElement("div",{className:"center"},p.default.createElement("div",{className:"name"},e.productName),p.default.createElement("div",{className:"price"},e.price,p.default.createElement("span",{className:"small"},"元起"),p.default.createElement("s",{className:"del-price"},e.faceValue,"元起")),e.couponContent&&e.couponContent[0]?p.default.createElement("div",{className:"label-bg"},e.couponContent.map(function(e,t){if(t<2)return p.default.createElement("span",null,e)})):""),p.default.createElement(c.default,{className:"right"},"购买"))},a.onEndReached=function(){var e=a.state,t=e.postData,o=e.isSearchFinish,n=e.isSearchAll;a.setState({isLoadScroll:!0}),o&&!n&&(t.pageIndex++,a.setState({postData:t},function(){a.getCouponsGoods()}))};var o=localStorage.getItem("shopInfo")?JSON.parse(localStorage.getItem("shopInfo")):{},n=(0,g.default)(e.location.search,!0).query,s=n.cardId,u=n.reachedAmount,f=n.reduceAmount,m=new l.default.DataSource({rowHasChanged:function(e,t){return e!==t}});return a.consignList=[],a.state={manageDataSource:m.cloneWithRows([]),isSearchFinish:!1,isLoadScroll:!1,isSearchAll:!1,dataSource:[],secondMenu:[],goodsList:[],secondTotal:-1,shopInfo:o,banner:[],cardId:s,reachedAmount:u,reduceAmount:f,postData:{couponCode:s,pageIndex:1,pageSize:9}},a}return(0,f.default)(t,e),(0,u.default)(t,[{key:"componentWillMount",value:function(){scrollTo(0,0),this.state.cardId?this.getCouponsGoods():this.props.history.push("/")}},{key:"componentWillReceiveProps",value:function(e){var t=this,a=this.props,o=e.coupons.GetCouponProductList;if(o!==a.coupons.GetCouponProductList){var l,c=o.code,r=o.data,i=o.message;if("1000"===c)if(r&&r.list)(l=this.consignList).push.apply(l,(0,s.default)(r.list)),r.current>=r.pageTotal&&this.setState({isSearchAll:!0}),this.setState({dataSource:[].concat((0,s.default)(this.consignList)),total:r.total,isSearchFinish:!0,isLoadScroll:!1},function(){t.setState({manageDataSource:t.state.manageDataSource.cloneWithRows(t.state.dataSource)})});else this.setState({dataSource:[],total:0,isSearchFinish:!0,isLoadScroll:!1});else n.default.info(i)}}},{key:"render",value:function(){var e=this,t=this.state,a=t.manageDataSource,n=t.secondTotal,s=t.postData,c=t.isSearchAll,r=t.reachedAmount,i=t.reduceAmount;return p.default.createElement("div",{className:"couPage-bg"},p.default.createElement(h.default,(0,o.default)({},this.props,{myLoading:!!this.props.loading.models.coupons})),p.default.createElement("div",{className:"two-list"},i&&i&&p.default.createElement("div",{className:"tips"},"以下商品可使用",p.default.createElement("span",{className:"redfont"},r>0?"每满"+r+"减"+i:i+"元无门槛"),"优惠券"),p.default.createElement("ul",null,0!==n?p.default.createElement(l.default,{className:"list-view",dataSource:a,renderRow:this.renderRow,initialListSize:s.pageSize,pageSize:s.pageSize,onEndReachedThreshold:80,onEndReached:this.onEndReached,renderFooter:c&&function(){return p.default.createElement("div",{className:"no-more"},"--我是有底线的--")}}):"")),0===n?p.default.createElement("div",{className:"noting"},p.default.createElement("span",null),"暂无数据"):"",p.default.createElement("div",{className:"cover-icon",onClick:function(){e.props.history.push("/mycoupons")}}))}}]),t}(p.default.Component);t.default=(0,m.connect)(function(e){return(0,o.default)({},e)})(v)},CacY:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n=a("6/QC"),s=(o=n)&&o.__esModule?o:{default:o};t.default=s.default}}]);